<!--pages/index/index.wxml-->
<view class="container">
  <!-- ä¸»èƒŒæ™¯å›¾ç‰‡ -->
  <view class="hero-section">
    <image class="hero-bg" src="/images/birdies.jpg" mode="aspectFill" />
    <view class="hero-overlay">
      <text class="hero-title">ç¾½æ¯›çƒæ´»åŠ¨</text>
      <text class="hero-subtitle">çƒ­çˆ±ç¾½æ¯›çƒï¼Œäº«å—è¿åŠ¨ä¹è¶£</text>
    </view>
  </view>

  <!-- é¡¶éƒ¨æœç´¢æ  -->
  <view class="search-bar">
    <view class="search-input">
      <text class="search-icon">ğŸ”</text>
      <input placeholder="æœç´¢æ´»åŠ¨..." bindinput="onSearchInput" value="{{searchKeyword}}" />
    </view>
  </view>

  <!-- æ´»åŠ¨åˆ—è¡¨ -->
  <view class="activity-list">
    <view wx:if="{{activities.length === 0 && !loading}}" class="empty-state">
      <text class="icon">ğŸ¸</text>
      <text class="text-body">æš‚æ— æ´»åŠ¨</text>
      <text class="text-caption mt-16">ç®¡ç†å‘˜è¿˜æ²¡æœ‰å‘å¸ƒæ´»åŠ¨</text>
    </view>

    <view wx:for="{{activities}}" wx:key="id" class="activity-card" bindtap="onActivityTap" data-id="{{item.id}}">
      <!-- æ´»åŠ¨æ ‡é¢˜ -->
      <view class="activity-header">
        <text class="activity-title text-title">{{item.title}}</text>
        <view class="status-tag {{item.status === 'active' ? 'status-active' : item.status === 'full' ? 'status-full' : 'status-ended'}}">
          {{item.status === 'active' ? 'è¿›è¡Œä¸­' : item.status === 'full' ? 'å·²æ»¡å‘˜' : 'å·²ç»“æŸ'}}
        </view>
      </view>

      <!-- æ´»åŠ¨ä¿¡æ¯ -->
      <view class="activity-info">
        <view class="info-item">
          <text class="info-icon">ğŸ•</text>
          <text class="info-text">{{item.date}} {{item.time}}</text>
        </view>
        <view class="info-item">
          <text class="info-icon">ğŸ“</text>
          <text class="info-text">{{item.location}}</text>
        </view>
        <view class="info-item" wx:if="{{item.rules}}">
          <text class="info-icon">ğŸ“‹</text>
          <text class="info-text">{{item.rules}}</text>
        </view>
      </view>

      <!-- æŠ¥åè¿›åº¦ -->
      <view class="activity-progress">
        <view class="progress-info">
          <text class="text-body">å·²æŠ¥å {{item.joinedCount}}/{{item.maxCount || 'ä¸é™'}} äºº</text>
          <text class="text-caption">{{item.joinedCount}}äººå‚ä¸</text>
        </view>
        <view class="progress-bar" wx:if="{{item.maxCount}}">
          <view class="progress-fill" style="width: {{(item.joinedCount / item.maxCount * 100)}}%"></view>
        </view>
      </view>

      <!-- æœ€æ–°æŠ¥åç”¨æˆ· -->
      <view class="recent-joiners" wx:if="{{item.recentJoiners && item.recentJoiners.length > 0}}">
        <text class="text-caption">æœ€è¿‘æŠ¥åï¼š</text>
        <view class="joiners-list">
          <view wx:for="{{item.recentJoiners}}" wx:key="id" wx:for-item="joiner" class="joiner-item">
            <image class="avatar avatar-small" src="{{joiner.avatar || '/images/default-avatar.png'}}" />
            <text class="joiner-name">{{joiner.name}}</text>
          </view>
        </view>
      </view>
    </view>
  </view>

  <!-- åŠ è½½æ›´å¤š -->
  <view wx:if="{{loading}}" class="loading">
    <text>åŠ è½½ä¸­...</text>
  </view>

  <!-- æµ®åŠ¨å‘å¸ƒæŒ‰é’®ï¼ˆç®¡ç†å‘˜å¯è§ï¼‰ -->
  <view wx:if="{{isAdmin}}" class="fab" bindtap="onCreateActivity">
    <text class="fab-icon">+</text>
  </view>
</view>
