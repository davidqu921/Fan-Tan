<!--pages/admin/users.wxml-->
<view class="container">
  <!-- èƒŒæ™¯è£…é¥° -->
  <view class="bg-decoration">
    <image class="bg-image" src="/images/lcw.jpg" mode="aspectFill" />
    <view class="bg-overlay"></view>
  </view>

  <!-- é¡µé¢æ ‡é¢˜ -->
  <view class="page-header">
    <text class="page-title text-title">ç”¨æˆ·ç®¡ç†</text>
    <text class="page-subtitle text-caption">ç®¡ç†ç³»ç»Ÿç”¨æˆ·</text>
  </view>

  <!-- ç”¨æˆ·ç»Ÿè®¡ -->
  <view class="stats-section">
    <view class="stat-card card">
      <text class="stat-number">{{userStats.total}}</text>
      <text class="stat-label text-caption">æ€»ç”¨æˆ·æ•°</text>
    </view>
    <view class="stat-card card">
      <text class="stat-number">{{userStats.admins}}</text>
      <text class="stat-label text-caption">ç®¡ç†å‘˜</text>
    </view>
    <view class="stat-card card">
      <text class="stat-number">{{userStats.active}}</text>
      <text class="stat-label text-caption">æ´»è·ƒç”¨æˆ·</text>
    </view>
  </view>

  <!-- ç”¨æˆ·åˆ—è¡¨ -->
  <view class="users-section">
    <view class="section-header">
      <text class="section-title text-subtitle">ç”¨æˆ·åˆ—è¡¨</text>
      <button class="btn btn-outline refresh-btn" bindtap="refreshUsers">
        <text class="btn-icon">ğŸ”„</text>
        åˆ·æ–°
      </button>
    </view>

    <view wx:if="{{loading}}" class="loading-container">
      <text class="loading-text text-caption">åŠ è½½ä¸­...</text>
    </view>

    <view wx:elif="{{users.length === 0}}" class="empty-container">
      <text class="empty-icon">ğŸ‘¥</text>
      <text class="empty-text text-caption">æš‚æ— ç”¨æˆ·æ•°æ®</text>
    </view>

    <view wx:else class="users-list">
      <view wx:for="{{users}}" wx:key="uid" class="user-card card">
        <view class="user-avatar">
          <image 
            class="avatar" 
            src="{{item.avatar || '/images/default-avatar.png'}}" 
            mode="aspectFill"
          />
        </view>
        
        <view class="user-info">
          <view class="user-name">
            <text class="name text-body">{{item.displayName}}</text>
            <view class="role-badge {{item.role}}">
              <text class="role-text">{{item.role === 'admin' ? 'ç®¡ç†å‘˜' : 'ç”¨æˆ·'}}</text>
            </view>
          </view>
          
          <view class="user-details">
            <text class="detail-item text-caption">ğŸ“§ {{item.email}}</text>
            <text wx:if="{{item.phone}}" class="detail-item text-caption">ğŸ“± {{item.phone}}</text>
            <text wx:if="{{item.wechat}}" class="detail-item text-caption">ğŸ’¬ {{item.wechat}}</text>
          </view>
          
          <view class="user-meta">
            <text class="meta-item text-caption">æ³¨å†Œæ—¶é—´ï¼š{{item.createdAt}}</text>
            <text class="status-badge {{item.status}}">{{item.status === 'active' ? 'æ´»è·ƒ' : 'éæ´»è·ƒ'}}</text>
          </view>
        </view>
        
        <view class="user-actions">
          <button 
            class="btn btn-outline action-btn" 
            bindtap="toggleUserStatus" 
            data-uid="{{item.uid}}"
            data-status="{{item.status}}"
          >
            {{item.status === 'active' ? 'ç¦ç”¨' : 'å¯ç”¨'}}
          </button>
        </view>
      </view>
    </view>
  </view>
</view>
